<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dusty</title>
  <link rel="stylesheet" href="index.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="loading-bar.css" />
  <script type="text/javascript" src="loading-bar.js"></script>

</head>

<body>
  <div class="dustbin-outer-div">
    <div class="heading-bar">
      <h2>Dashboard</h2>
    </div>

    <div class="dustbin-section">
      <div class="dustbin">
        <h3>Dustbin 1</h3>

        <div class="dustbin-container">

          <div id="db1" class="ldBar label-center" data-type="fill" data-img="trash3.svg" data-fill-background="grey" data-fill-background-extrude="0" data-img-size="300,300" data-value="35"></div>


        </div>


       
      </div>
      <div class="dustbin">
        <h3>Dustbin 2</h3>
        <div class="dustbin-container">

          <div id="db2" class="ldBar label-center" data-type="fill" data-img="trash3.svg" data-fill-background="grey" data-fill-background-extrude="0" data-img-size="300,300"></div>

        </div>

       

      </div>
      <div id="dustbin3" class="dustbin">
        <h3>Dustbin 3</h3>
        <div class="dustbin-container">

          <div id="db3" class="ldBar label-center" data-type="fill" data-img="trash3.svg" data-fill-background="grey" data-fill-background-extrude="0" data-img-size="300,300"></div>

        </div>

       

      </div>
      
      
  
  </div>
  <button id="Refresh" type="button" class="btn btn-primary" name="button">Refresh</button>
  <div class="Adding">
        
    <h3 id="Addd">Add Dustbin</h3>
    <form id="form" action="http://">
      <label for="fname">Add IP</label><br>
      <input type="text" id="fname" name="fname"><br>
    
    <div class="dustbin-container">
      <div class="add-dustbin">
        <button id="addButton" type="button" class="btn btn-primary" name="button">Add</button>
     
       
      </div>
    </div>

</div>

  <script>
    var db1 = new ldBar("#db1");
    var db1 = document.getElementById('db1').ldBar;
    db1.set(0);

    var db2 = new ldBar("#db2");
    var db2 = document.getElementById('db2').ldBar;
    db2.set(0);

    var db3 = new ldBar("#db3");
    var db3 = document.getElementById('db3').ldBar;
    db3.set(0);

    var button = document.getElementById('Refresh');
    button.addEventListener('click', fetchApi);

    var button2 = document.getElementById('Refresh');
    button2.addEventListener('click', fetchApi2);

    var button3 = document.getElementById('addButton');
    button3.addEventListener('click', fetchApi3);

    var dustbin3 = document.getElementById('dustbin3');
    dustbin3.style.display = "block";
    //catch the input from the form 
    // var form = document.getElementById('form');
    // form.addEventListener('click', (e)=>{
    //   e.preventDefault();
    //   var input = document.getElementById('fname').value;
    //   console.log(input);
    // });

function fetchApi() {
      fetch('http://dustbin1.local/getdistance')
        .then(response => response.json())
        .then(data => {
          console.log(data);
          var message =(220 - +data.message);

           db1.set(message);
           console.log(message);
        })
    }
function fetchApi2() {
      fetch('http://dustbin2.local/getdistance')
        .then(response => response.json())
        .then(data => {
          console.log(data);
          var message =(100 - +data.message);
           db2.set(message);
        })
    }
  
//create fetch api for dustbin 3 which takes api as input
function fetchApi3(api) {
      // fetch(api)
      //   .then(response => response.json())
      //   .then(data => {
      //     console.log(data);
      //     var message =(100 - +data.message);
      //      db3.set(message);
      //   })
      db3.set(50);
    }
  
    // add new dustbin when button is clicked
    var addButton = document.getElementById('addButton');
    addButton.addEventListener('click', ()=>{
     addButton.style.display = "none";
      var form = document.getElementById('form');
      form.style.display = "none";
      var add = document.getElementById('Addd');
      add.style.display = "none";
      //printing input value
      var input = form.value;
      fetchApi3(input);  
    });


    
   
  </script>




</body>

</html>
